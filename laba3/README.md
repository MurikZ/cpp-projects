
# Модель песчаной кучи

Это консольное приложение реализует упрощённую модель песчаной кучи (sandpile model) с возможностью визуализации результата в виде BMP-изображения.

## Структура проекта

.
├── input/                 # Входные TSV-файлы для main и tests
│   ├── main_input.tsv
│   └── test_input.tsv
├── lib/
│   ├── Sandpile.h / .cpp  # Класс модели песчаной кучи
│   ├── BmpWriter.h / .cpp # Класс для сохранения изображения
├── main.cpp               # Главный файл для запуска симуляции
├── tests.cpp              # Тесты с использованием Google Test
├── CMakeLists.txt         # Файл сборки CMake

```

---

## Как работает

Модель песчаной кучи работает по следующим правилам:
- Каждая ячейка поля содержит количество зёрен песка.
- Если в ячейке ≥ 4 зёрен, она "обваливается", распределяя по одному зерну четырём соседям.
- Процесс продолжается, пока все ячейки стабильны (меньше 4 зёрен).

---

## Запуск симуляции

1. Поместите входной файл `main_input.tsv` в папку `input/`.
2. Соберите проект с помощью CMake.
3. Запустите `sandpile_app.exe` в консоли или `launch_main.bat`:

```bash
build/bin/sandpile_app.exe
```

4. Итоговая картинка появится в корне проекта под именем `output.bmp`.

---

## Тестирование

Тесты используют файл `test_input.tsv` и проверяют:
- Корректность загрузки данных
- Запуск симуляции
- Размер поля
- Стабильность результата
- Наличие зёрен после симуляции

Запуск тестов:

```bash
build/tests/sandpile_tests.exe
```

---

## Пример результата

Результат симуляции сохраняется в BMP-файл, где цвет каждой ячейки зависит от количества зёрен песка:

- 0 зёрен — белый
- 1 зёрно  — зелёный
- 2 зёрна — розовый
- 3 зёрна — жёлтый


## Используемые технологии

- C++
- Google Test (gtest)
- CMake
- BMP-формат вывода

